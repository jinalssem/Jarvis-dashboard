<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– Jarvis Trading Bot - Live Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #ffffff;
            padding: 20px;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header p {
            color: #9ca3af;
            font-size: 1.1rem;
        }
        .status {
            margin-top: 10px;
            color: #6ee7b7;
        }
        
        /* ì›Œë“œí´ë¼ìš°ë“œ */
        .wordcloud-container {
            position: relative;
            height: 200px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .wordcloud-word {
            position: absolute;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
            white-space: nowrap;
        }
        .wordcloud-word:hover {
            transform: scale(1.2);
        }
        .word-profit {
            color: #10b981;
        }
        .word-loss {
            color: #ef4444;
        }
        .word-neutral {
            color: #9ca3af;
        }
        
        @keyframes drift {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(20px, -10px) rotate(5deg);
            }
            50% {
                transform: translate(-10px, 10px) rotate(-3deg);
            }
            75% {
                transform: translate(15px, 5px) rotate(2deg);
            }
        }
        .coin-drift {
            animation: drift 8s ease-in-out infinite;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            transition: transform 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: rgba(102, 126, 234, 0.5);
        }
        .stat-label {
            color: #9ca3af;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
        }
        .positive {
            color: #10b981;
        }
        .negative {
            color: #ef4444;
        }
        .section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .holdings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }
        .holding-card {
            background: rgba(255, 255, 255, 0.08);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }
        .holding-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.12);
        }
        .holding-card .coin {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .holding-card .rate {
            font-size: 1.1rem;
            margin: 10px 0;
        }
        .holding-card .value {
            color: #9ca3af;
            font-size: 0.9rem;
        }
        .trade-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }
        .trade-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(102, 126, 234, 0.3);
        }
        .trade-time {
            color: #9ca3af;
            min-width: 80px;
        }
        .trade-market {
            font-weight: bold;
            min-width: 80px;
        }
        .trade-action {
            padding: 4px 12px;
            border-radius: 5px;
            font-size: 0.85rem;
            min-width: 60px;
            text-align: center;
        }
        .action-buy {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        .action-sell {
            background: rgba(168, 85, 247, 0.2);
            color: #a855f7;
        }
        
        /* ì¶”ì²œ ì½”ë“œ */
        .referral-section {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 1px solid rgba(102, 126, 234, 0.3);
        }
        .referral-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .referral-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .referral-item:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: scale(1.05);
        }
        .referral-label {
            color: #9ca3af;
            font-size: 0.85rem;
            margin-bottom: 8px;
        }
        .referral-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        /* ìŒì•… ì»¨íŠ¸ë¡¤ */
        .music-control {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        .music-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
        }
        .music-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }
        .volume-slider {
            display: none;
            position: absolute;
            bottom: 70px;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        .volume-slider.show {
            display: block;
        }
        
        .loading {
            text-align: center;
            color: #9ca3af;
            padding: 20px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¤– Jarvis Trading Bot</h1>
            <p>ì‹¤ì‹œê°„ ê±°ë˜ ëŒ€ì‹œë³´ë“œ - ë¶ˆë© ëª¨ë“œ ğŸ”¥ğŸµ</p>
            <div class="status">
                ğŸŸ¢ Live | Last update: <span id="lastUpdate">Loading...</span>
            </div>
        </div>

        <!-- ì›Œë“œí´ë¼ìš°ë“œ -->
        <div class="wordcloud-container" id="wordcloud">
            <div class="loading">ê±°ë˜ ë°ì´í„° ë¡œë”© ì¤‘...</div>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">ğŸ’° ì˜¤ëŠ˜ ì†ìµ</div>
                <div class="stat-value" id="todayProfit">
                    <div class="loading">Loading...</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ğŸ“ˆ ëˆ„ì  ì†ìµ</div>
                <div class="stat-value" id="totalProfit">
                    <div class="loading">Loading...</div>
                </div>
            </div>
        </div>

        <!-- Holdings -->
        <div class="section">
            <div class="section-title">ğŸ’¼ ë³´ìœ  ì½”ì¸</div>
            <div class="holdings-grid" id="holdings">
                <div class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</div>
            </div>
        </div>

        <!-- Recent Trades -->
        <div class="section">
            <div class="section-title">ğŸ“Š ìµœê·¼ ê±°ë˜</div>
            <div id="recentTrades">
                <div class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</div>
            </div>
        </div>

        <!-- ì¶”ì²œ ì½”ë“œ -->
        <div class="section referral-section">
            <div class="section-title">ğŸ ë¹—ì¸ ì¹œêµ¬ ì´ˆëŒ€</div>
            <p style="color: #9ca3af; margin-bottom: 15px;">
                ì¶”ì²œì¸ ì½”ë“œë¡œ ê°€ì…í•˜ë©´ ìˆ˜ìˆ˜ë£Œ í• ì¸ í˜œíƒì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
            </p>
            <div class="referral-grid">
                <div class="referral-item" onclick="copyToClipboard('YOUR_REFERRAL_CODE')">
                    <div class="referral-label">ì¶”ì²œì¸ ì½”ë“œ</div>
                    <div class="referral-value">YOUR_CODE</div>
                </div>
                <div class="referral-item" onclick="window.open('https://www.bithumb.com', '_blank')">
                    <div class="referral-label">ë¹—ì¸ ê°€ì…í•˜ê¸°</div>
                    <div class="referral-value">ğŸ”— ì´ˆëŒ€ ë§í¬</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ìŒì•… ì»¨íŠ¸ë¡¤ -->
    <div class="music-control">
        <button class="music-btn" id="musicBtn" onclick="toggleMusic()">ğŸµ</button>
        <div class="volume-slider" id="volumeSlider">
            <input type="range" min="0" max="100" value="30" id="volumeControl" 
                   onchange="setVolume(this.value)" style="width: 100px;">
        </div>
    </div>

    <!-- ë°°ê²½ìŒì•… -->
    <audio id="bgMusic" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <script>
        let wordCloudWords = [];
        const maxWords = 50;

        async function loadData() {
            try {
                const response = await fetch('dashboard_data.json');
                if (!response.ok) throw new Error('Data not found');
                const data = await response.json();
                updateDashboard(data);
            } catch (error) {
                console.log('Using test data:', error.message);
                updateDashboard(getTestData());
            }
        }

        function updateDashboard(data) {
            // Last Update
            const lastUpdate = data.last_update ? 
                new Date(data.last_update).toLocaleString('ko-KR') : 'ë°©ê¸ˆ ì „';
            document.getElementById('lastUpdate').textContent = lastUpdate;

            // ì˜¤ëŠ˜ ì†ìµ
            const todayProfit = data.today_profit || 0;
            const todayPercent = data.today_profit_percent || 0;
            const todayClass = todayProfit >= 0 ? 'positive' : 'negative';
            document.getElementById('todayProfit').innerHTML = 
                `<span class="${todayClass}">${todayProfit >= 0 ? '+' : ''}${todayProfit.toLocaleString()}ì› (${todayPercent >= 0 ? '+' : ''}${todayPercent.toFixed(2)}%)</span>`;

            // ëˆ„ì  ì†ìµ
            const totalProfit = data.total_profit || 0;
            const totalPercent = data.total_profit_percent || 0;
            const totalClass = totalProfit >= 0 ? 'positive' : 'negative';
            document.getElementById('totalProfit').innerHTML = 
                `<span class="${totalClass}">${totalProfit >= 0 ? '+' : ''}${totalProfit.toLocaleString()}ì› (${totalPercent >= 0 ? '+' : ''}${totalPercent.toFixed(2)}%)</span>`;

            // ì›Œë“œí´ë¼ìš°ë“œ ì—…ë°ì´íŠ¸
            updateWordCloud(data);

            // ë³´ìœ  ì½”ì¸
            const holdings = data.holdings || [];
            if (holdings.length > 0) {
                document.getElementById('holdings').innerHTML = holdings.map(h => {
                    const rateClass = h.profit_rate >= 0 ? 'positive' : 'negative';
                    return `
                        <div class="holding-card">
                            <div class="coin">${h.market.replace('KRW-', '')}</div>
                            <div class="rate ${rateClass}">${h.profit_rate >= 0 ? '+' : ''}${(h.profit_rate * 100).toFixed(2)}%</div>
                            <div class="value">${h.value.toLocaleString()}ì›</div>
                        </div>
                    `;
                }).join('');
            } else {
                document.getElementById('holdings').innerHTML = 
                    '<div class="loading">ë³´ìœ  ì½”ì¸ ì—†ìŒ</div>';
            }

            // ìµœê·¼ ê±°ë˜
            const trades = data.recent_trades || [];
            if (trades.length > 0) {
                document.getElementById('recentTrades').innerHTML = trades.slice(0, 10).map(t => {
                    const profitClass = t.profit >= 0 ? 'positive' : 'negative';
                    const actionClass = t.action === 'buy' ? 'action-buy' : 'action-sell';
                    const emoji = t.profit >= 0 ? 'ğŸ˜Š' : 'ğŸ˜¢';
                    return `
                        <div class="trade-item">
                            <span class="trade-time">${t.time}</span>
                            <span class="trade-market">${t.market.replace('KRW-', '')}</span>
                            <span class="trade-action ${actionClass}">${t.action === 'buy' ? 'ë§¤ìˆ˜' : 'ë§¤ë„'}</span>
                            <span class="${profitClass}">${t.profit >= 0 ? '+' : ''}${t.profit.toLocaleString()}ì› ${emoji}</span>
                        </div>
                    `;
                }).join('');
            } else {
                document.getElementById('recentTrades').innerHTML = 
                    '<div class="loading">ê±°ë˜ ë‚´ì—­ ì—†ìŒ</div>';
            }
        }

        function updateWordCloud(data) {
            const container = document.getElementById('wordcloud');
            
            // ìµœê·¼ ê±°ë˜ì—ì„œ ë‹¨ì–´ ì¶”ê°€
            if (data.recent_trades && data.recent_trades.length > 0) {
                data.recent_trades.slice(0, 5).forEach(trade => {
                    const coin = trade.market.replace('KRW-', '');
                    const rate = trade.profit_rate || 0;
                    const text = `${coin} ${rate >= 0 ? '+' : ''}${(rate * 100).toFixed(1)}%`;
                    addWordToCloud(text, rate >= 0 ? 'profit' : 'loss', false);
                });
            }
            
            // ë³´ìœ  ì½”ì¸ì—ì„œ ë‹¨ì–´ ì¶”ê°€
            if (data.holdings && data.holdings.length > 0) {
                data.holdings.forEach(holding => {
                    const coin = holding.market.replace('KRW-', '');
                    const rate = holding.profit_rate || 0;
                    const text = `${coin} ${rate >= 0 ? '+' : ''}${(rate * 100).toFixed(1)}%`;
                    addWordToCloud(text, rate >= 0 ? 'profit' : rate < 0 ? 'loss' : 'neutral', true);
                });
            }
            
            renderWordCloud();
        }

        function addWordToCloud(text, type, isPersistent) {
            // ì¤‘ë³µ ì œê±°
            wordCloudWords = wordCloudWords.filter(w => !w.text.startsWith(text.split(' ')[0]));
            
            wordCloudWords.push({
                text: text,
                type: type,
                isPersistent: isPersistent,
                timestamp: Date.now()
            });
            
            // ìµœëŒ€ ê°œìˆ˜ ìœ ì§€
            if (wordCloudWords.length > maxWords) {
                wordCloudWords = wordCloudWords.filter(w => w.isPersistent).concat(
                    wordCloudWords.filter(w => !w.isPersistent).slice(-20)
                );
            }
        }

        function renderWordCloud() {
            const container = document.getElementById('wordcloud');
            container.innerHTML = '';
            
            wordCloudWords.forEach((word, index) => {
                const wordEl = document.createElement('div');
                wordEl.className = `wordcloud-word word-${word.type} coin-drift`;
                wordEl.textContent = word.text;
                
                // ëœë¤ ìœ„ì¹˜
                const left = Math.random() * 80 + 5;
                const top = Math.random() * 60 + 20;
                const size = word.isPersistent ? 1.2 + Math.random() * 0.5 : 1 + Math.random() * 0.3;
                
                wordEl.style.left = left + '%';
                wordEl.style.top = top + '%';
                wordEl.style.fontSize = size + 'rem';
                wordEl.style.animationDelay = (index * 0.5) + 's';
                
                container.appendChild(wordEl);
            });
        }

        function getTestData() {
            return {
                today_profit: 125430,
                today_profit_percent: 2.3,
                total_profit: 1234567,
                total_profit_percent: 15.2,
                recent_trades: [
                    { time: "23:45:15", market: "KRW-BTC", action: "sell", profit: 12345, profit_rate: 0.025 },
                    { time: "23:42:22", market: "KRW-ETH", action: "sell", profit: -3210, profit_rate: -0.015 },
                    { time: "23:40:08", market: "KRW-XRP", action: "buy", profit: 0, profit_rate: 0 }
                ],
                holdings: [
                    { market: "KRW-XRP", value: 670000, profit_rate: 0.0308 },
                    { market: "KRW-DOGE", value: 590000, profit_rate: -0.0167 },
                    { market: "KRW-ADA", value: 1008000, profit_rate: 0.008 }
                ],
                last_update: new Date().toISOString()
            };
        }

        // ìŒì•… ì»¨íŠ¸ë¡¤
        function toggleMusic() {
            const music = document.getElementById('bgMusic');
            const btn = document.getElementById('musicBtn');
            const slider = document.getElementById('volumeSlider');
            
            if (music.paused) {
                music.play();
                btn.textContent = 'ğŸµ';
                slider.classList.add('show');
            } else {
                music.pause();
                btn.textContent = 'ğŸ”‡';
                slider.classList.remove('show');
            }
        }

        function setVolume(value) {
            const music = document.getElementById('bgMusic');
            music.volume = value / 100;
        }

        // í´ë¦½ë³´ë“œ ë³µì‚¬
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ì¶”ì²œì¸ ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤: ' + text);
            });
        }

        // ì´ˆê¸° ë¡œë“œ
        loadData();
        setInterval(loadData, 30000);
        
        // ì´ˆê¸° ë³¼ë¥¨ ì„¤ì •
        document.getElementById('bgMusic').volume = 0.3;
    </script>
</body>
</html>
